<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.spring.project.restful.dao.RestfulDAO">
	<select id="getMessages" resultType="com.spring.project.restful.vo.Message">
		SELECT MESSAGECODE
	    , m.usernumber
	    , m.SENDUSER
	    , MESSAGE
	    , READSTATUS
	    , SENDTIME
	    , EXTRACT(DAY FROM SYSTIMESTAMP-SENDTIME) day
	    , EXTRACT(HOUR FROM SYSTIMESTAMP-SENDTIME) hour
	    , EXTRACT(MINUTE FROM SYSTIMESTAMP-SENDTIME) min
	    , EXTRACT(SECOND FROM SYSTIMESTAMP-SENDTIME) sec
	    , NOTIFYSTATUS
	    , u.userimage as senduserimage
	    FROM messages m JOIN users u
	    ON m.senduser = u.usernumber
	    WHERE m.usernumber = #{userNumber}
	    AND readstatus = 0
	    ORDER BY sendtime desc
	</select>
</mapper>